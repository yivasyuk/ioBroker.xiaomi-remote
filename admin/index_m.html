<html>
<head>
	<!-- Load ioBroker scripts and styles-->
	<link rel="stylesheet" type="text/css" href="../../css/adapter.css" />
	<link rel="stylesheet" type="text/css" href="../../lib/css/materialize.css">

	<script type="text/javascript" src="../../lib/js/jquery-3.2.1.min.js"></script>
	<script type="text/javascript" src="../../socket.io/socket.io.js"></script>

	<script type="text/javascript" src="../../js/translate.js"></script>
	<script type="text/javascript" src="../../lib/js/materialize.js"></script>
	<script type="text/javascript" src="../../js/adapter-settings.js"></script>

	<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.css" />
	<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid-theme.min.css" />
	<link rel="stylesheet" type="text/css" href="style.css" />

	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.js"></script>
	<script type="text/javascript" src="admin.js"></script>

	<script>
		if (typeof exports === 'undefined') {
			Object.defineProperty(window, "exports", {});
		}
	</script>
	<script type="text/javascript" src="dep.js"></script>

	<script type="text/javascript" src="words.js"></script>

	<script type="text/javascript">
		let remoteData;
		
		// This will be called by the admin adapter when the settings page loads
		function load(settings, onChange) {
			dep.log()
			console.log(settings)
			onDataChange = onChange;
			onChange(false);

			// reinitialize all the Materialize labels on the page if you are dynamically adding inputs:
			if (M) M.updateTextFields();
			
			if (settings) {
				if (settings.remotes && settings.remotes.length > 0) {
					remoteData = settings.remotes[0];
				}
			}
			else {
				remoteData = {
					id: '7228af64-4562-435e-8636-7c9530e520fb',
					name: 'rgbSimple',
					buttons: [
						//  { id:'7228af64-4562-435e-8636-7c9530e520fb', name: 'On', checkData: {checked: true}, code: '' },
						//  { id:'f0433778-be8e-49b8-9d99-3a849abd8a82', name: 'Off', checkData: {checked: false}, code: '' }
					]
				};
			}
			bindData();
		}

		// This will be called by the admin adapter when the user presses the save button
		function save(callback) {
			const settings = {
					ipAddress: '192.168.1.81',
					token: '07d2065c8ed662c8ed9ac36cbb6d0a6b',
					remotes: [
						{
							id: remoteData.id,
							name: remoteData.name,
							buttons: remoteData.buttons.map(b => ({ id: b.id, name: b.name, code: b.code }))
						}
					]
				}
			console.log(settings)

			callback(settings);
		}
	</script>
</head>

<body>
	<div class="m adapter-container">

		<div class="row">
			<div class="col s12 m4 l2">
				<img src="xiaomi-remote.png" class="logo">
			</div>
		</div>

		<div style="padding: 15px">
			<input id="txtRemoteName" type="text" placeholder="remote name">
		</div>
		
		<div id="jsGrid"></div>

	</div>
</body>
</html>